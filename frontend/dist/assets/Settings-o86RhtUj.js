import{a as D,r,j as e}from"./index-ChEDcgwN.js";import{S as q}from"./Sidebar-Wh0uZx9g.js";import{a as E}from"./axios-CmsuhreG.js";function $(){const{theme:m,setTheme:p}=D(),[d,j]=r.useState("Profile"),[h,y]=r.useState(!1),[c,x]=r.useState(""),[l,w]=r.useState(""),[i,g]=r.useState(""),[f,o]=r.useState(""),[b,u]=r.useState(""),P=localStorage.getItem("examinationCellToken"),[t,v]=r.useState({name:"",regNo:"",oldPassword:"",newPassword:"",confirmPassword:""}),[S,C]=r.useState(!1),[k,N]=r.useState(!1),n=s=>{v({...t,[s.target.name]:s.target.value})},T=async s=>{if(s.preventDefault(),t.newPassword!==t.confirmPassword){alert("New password and confirm password do not match");return}N(!0);try{const a=await E.post("https://examinationcell-backend.onrender.com/api/v1/user/update",{regNo:t.regNo,name:t.name,password:t.newPassword});a.status===200?C(!0):alert(a.data.message)}catch(a){console.error("Error updating password:",a),alert("Error updating password. Please try again.")}N(!1)},A=async()=>{if(!c||!l||!i){o("All fields are required.");return}if(l!==i){o("Passwords do not match.");return}try{const s=await fetch("http://localhost:3000/api/v1/setting/delete-account",{method:"POST",headers:{"Content-Type":"application/json",Authorization:P||""},body:JSON.stringify({regdNumber:c,password:l})}),a=await s.json();s.ok?(u("Account deleted successfully."),o(""),x(""),w(""),g("")):(o(a.message||`Error: ${s.status}`),u(""))}catch(s){console.error("Fetch error:",s),o("Something went wrong."),u("")}};return e.jsxs("div",{className:"min-h-screen flex",children:[e.jsx(q,{}),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"flex justify-center border-b",children:["Profile","Theme","Account"].map(s=>e.jsx("button",{className:`px-6 py-3 text-lg ${d===s?"text-blue-500 border-b-2 border-blue-500 font-semibold":"text-gray-600"}`,onClick:()=>j(s),children:s},s))}),e.jsxs("div",{className:"flex justify-center items-center h-full p-6",children:[d==="Profile"&&e.jsx("p",{children:"Profile Settings"}),d==="Theme"&&e.jsxs("div",{className:"space-x-4",children:[e.jsx("button",{onClick:()=>p("light"),className:`px-4 py-2 rounded-md ${m==="light"?"bg-blue-500 text-white":"bg-gray-300"}`,children:"Light Mode"}),e.jsx("button",{onClick:()=>p("dark"),className:`px-4 py-2 rounded-md ${m==="dark"?"bg-blue-500 text-white":"bg-gray-600 text-white"}`,children:"Dark Mode"})]}),d==="Account"&&e.jsxs("div",{className:"w-96",children:[e.jsx("button",{onClick:()=>y(!h),className:"bg-red-600 text-white px-4 py-2 rounded-md w-full",children:"Delete Account"}),h&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Registration Number",className:"w-full px-3 py-2 border rounded-md",value:c,onChange:s=>x(s.target.value)}),e.jsx("input",{type:"password",placeholder:"Password",className:"w-full px-3 py-2 border rounded-md",value:l,onChange:s=>w(s.target.value)}),e.jsx("input",{type:"password",placeholder:"Confirm Password",className:"w-full px-3 py-2 border rounded-md",value:i,onChange:s=>g(s.target.value)}),f&&e.jsx("p",{className:"text-red-500",children:f}),b&&e.jsx("p",{className:"text-green-500",children:b}),e.jsx("button",{onClick:A,className:"bg-red-700 text-white px-4 py-2 rounded-md w-full",children:"Confirm Delete"})]})]})]}),e.jsx("div",{className:"flex justify-center items-center w-full",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 px-14",children:"Update New Password"}),e.jsxs("form",{onSubmit:T,className:"flex flex-col gap-4",children:[e.jsx("input",{type:"text",name:"name",placeholder:"Name",value:t.name,onChange:n,className:"border p-2 rounded",required:!0}),e.jsx("input",{type:"text",name:"regNo",placeholder:"Registration Number",value:t.regNo,onChange:n,className:"border p-2 rounded",required:!0}),e.jsx("input",{type:"password",name:"oldPassword",placeholder:"Old Password",value:t.oldPassword,onChange:n,className:"border p-2 rounded",required:!0}),e.jsx("input",{type:"password",name:"newPassword",placeholder:"New Password",value:t.newPassword,onChange:n,className:"border p-2 rounded",required:!0}),e.jsx("input",{type:"password",name:"confirmPassword",placeholder:"Confirm Password",value:t.confirmPassword,onChange:n,className:"border p-2 rounded",required:!0}),e.jsx("button",{type:"submit",className:"bg-blue-500 text-white p-2 rounded hover:bg-blue-600",children:k?"Updating...":"Change Password"})]}),S&&e.jsx("p",{className:"text-green-500 mt-2 text-center",children:"Password Updated Successfully!"})]})})]})]})}export{$ as default};
